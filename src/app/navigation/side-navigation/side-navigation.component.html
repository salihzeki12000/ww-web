<div class="top-nav-search">
  <div class="top-nav-link">
    <i class="fa fa-search fa-lg" aria-hidden="true" (mouseover)="showSearchOptions()"></i>

    <div class="top-nav-link-dropdown" *ngIf="searchOptions">
      <div class="dropdown-arrow-up"></div>
      <div class="top-nav-dropdown-header">
        <h6>SELECT SEARCH CATEGORY</h6>
      </div>
      <div class="dropdown-item" (click)="getUsers()">
        <h5>Search for people</h5>
      </div>
    </div>
  </div>
</div>

<div class="top-nav-itinerary">
  <div class="top-nav-link">
    <i class="fa fa-sticky-note fa-lg" aria-hidden="true" (mouseover)="showItineraryList()"></i>

    <div class="top-nav-link-dropdown" *ngIf="showItineraries">
      <div class="dropdown-arrow-up"></div>
      <div class="top-nav-dropdown-header">
        <h6>YOUR ITINERARIES</h6>
      </div>
      <h5 class="dropdown-new-itinerary" (click)="createItinerary()"><i class="fa fa-plus" aria-hidden="true"></i> Plan a new itinerary</h5>
      <div class="itinerary-list">
        <div *ngIf="currentUser?.itineraries.length === 0">
          <h5 class="nil-dropdown-item">No itinerary at the moment</h5>
        </div>
        <div *ngFor="let itinerary of currentUser?.itineraries" class="dropdown-item">
          <div [routerLink]="['itinerary/', itinerary._id]" (click)="hideItineraryList()">
            <h5>{{ itinerary.name }}</h5>
            <h6>( {{ itinerary.date_from | date:'dd MMM yy' }} to {{ itinerary.date_to | date:'dd MMM yy' }} )</h6>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="top-nav-follower-request">
  <div class="top-nav-link">
    <i class="fa fa-user-plus fa-lg" aria-hidden="true" (mouseover)="showFollowerRequestsList()"></i>

    <div class="top-nav-link-dropdown" *ngIf="showFollowerRequests">
      <div class="dropdown-arrow-up"></div>
      <div class="top-nav-dropdown-header">
        <h6>PENDING FOLLOWER REQUESTS</h6>
      </div>
      <div class="follower-requests-list">
        <div *ngIf="pendingFollowers.length === 0">
          <h5 class="nil-dropdown-item">No request at the moment</h5>
        </div>
        <div *ngFor="let request of pendingFollowers" class="dropdown-item">
          <img src="{{ request.user.display_picture }}" alt="" class="user-profile-thumbnail">
          <div class="user-details">
            <h5 class="user-username">{{ request.user.username }}</h5>
            <h6 class="user-search-description">{{ request.user.description }}</h6>
          </div>
          <div class="action-response" *ngIf="!request.responded">
            <h5 class="action-response-secondary" (click)="ignoreRequest(request)">IGNORE</h5>
            <h5 class="action-response-primary" (click)="acceptRequest(request)">ACCEPT</h5>
          </div>
          <div class="response-status" *ngIf="request.responded">
            <h5 *ngIf="request.request_accepted">Request Accepted</h5>
            <h5 *ngIf="request.request_ignored">Request Ignored</h5>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="top-nav-notifications">
  <div class="top-nav-link">
    <i class="fa fa-bell fa-lg" aria-hidden="true"  (mouseover)="showNotificationsList()"></i>

    <div class="top-nav-link-dropdown" *ngIf="showNotification">
      <div class="dropdown-arrow-up"></div>
      <div class="top-nav-dropdown-header">
        <h6>RECENT NOTIFICATIONS</h6>
        <p class="notifications-view-all" (click)="routeToNotifications()">view all</p>
        <span class="exit-notification-list" (click)="hideNotificationList()">X</span>
      </div>

      <ww-notification-list [notificationsLimit]="notificationsLimit"></ww-notification-list>
    </div>
  </div>
</div>

<div class="top-nav-profile">
  <div class="top-nav-link">
    <img src="{{ currentUser?.display_picture }}" class="user-profile-thumbnail" [routerLink]="['profile']" (mouseover)="showProfileOptions()">

    <div class="top-nav-link-dropdown" *ngIf="profileOptions">
      <div class="dropdown-arrow-up"></div>
      <div class="top-nav-dropdown-header">
        <h6>YOUR PROFILE SETTINGS</h6>
      </div>

      <div class="dropdown-item" (click)="hideProfileOptions()" [routerLink]="['profile']">
        <h5><i class="fa fa-user fa-fw" aria-hidden="true"></i> View profile</h5>
      </div>

      <div class="dropdown-item" (click)="hideProfileOptions()" [routerLink]="['profile-edit']">
        <h5><i class="fa fa-pencil fa-fw" aria-hidden="true"></i> Edit profile</h5>
      </div>

      <div class="dropdown-item" (click)="logout()" >
        <h5><i class="fa fa-sign-out fa-fw" aria-hidden="true"></i> Log out</h5>
      </div>
    </div>
  </div>
</div>

<div class="side-nav">
  <div class="custom-modal" *ngIf="showMenu" (click)="showSideMenu()"></div>

  <div class="side-nav-bars" (click)="showSideMenu()">
    <i class="fa fa-bars fa-2x" aria-hidden="true"></i>
  </div>

  <div class="side-nav-panel" [class.show-side-menu]="showMenu">

    <div class="profile">
      <img src="{{ currentUser?.display_picture }}" alt="" [routerLink]="['profile']" (click)="exitMenu()">
      <div class="edit-profile" [routerLink]="['profile-edit']" (click)="exitMenu()">
        <i class="fa fa-pencil" aria-hidden="true"></i>
      </div>
      <div class="username">
        <h4 [routerLink]="['profile']" (click)="exitMenu()">{{ currentUser?.username }}</h4>
      </div>
      <h5 class="user-description">{{ currentUser?.description }}</h5>
    </div>


    <div class="side-menu">
      <div class="side-menu-arrow-down"></div>
      <div>
        <div class="category-header" (click)="toggleConnectionsSection()">
          <h4>Connections <i class="fa fa-caret-down" aria-hidden="true"></i>
          </h4>
        </div>

        <div *ngIf="connectionsSection">

          <div class="category-item" (click)="getUsers()">
            <h5 class="search-connection">People search <i class="fa fa-search" aria-hidden="true"></i></h5>
          </div>

          <div class="follower-following-counter">
            <div class="follower-counter" (click)="routeToFollowers()">
              <h4>{{ followers.length }}</h4>
              <h5>FOLLOWERS</h5>
            </div>
            <div class="following-counter" (click)="routeToFollowings()">
              <h4>{{ followings.length }}</h4>
              <h5>FOLLOWING</h5>
            </div>
          </div>

          <div class="category-item" (click)="routeToPendingFollowers()">
            <h5>Follow requests</h5>
          </div>

        </div>
      </div>

      <div>
        <div class="category-header" (click)="toggleItinerariesSection()">
          <h4>Itineraries <i class="fa fa-caret-down" aria-hidden="true"></i></h4>
        </div>

        <div *ngIf="itinerariesSection">
          <div class="category-item">
            <h5 class="new-itinerary" (click)="createItinerary()"><i class="fa fa-plus" aria-hidden="true"></i> Plan a new itinerary</h5>
          </div>
          <div class="itinerary-list">
            <div *ngFor="let itinerary of currentUser?.itineraries" class="category-item">
              <div [routerLink]="['itinerary/', itinerary._id]" routerLinkActive="active" (click)="exitMenu()">
                <h5>{{ itinerary.name }}</h5>
                <h6>( {{ itinerary.date_from | date:'dd MMM yy' }} to {{ itinerary.date_to | date:'dd MMM yy' }} )</h6>
              </div>
            </div>
          </div>
        </div>

      </div>

      <div>
        <div class="category-header" (click)="toggleSettingsSection()">
          <h4>Settings <i class="fa fa-caret-down" aria-hidden="true"></i></h4>
        </div>
        <div *ngIf="settingsSection">
          <div class="category-item" (click)="logout()">
            <h5><i class="fa fa-sign-out" aria-hidden="true"></i> Logout</h5>
          </div>
        </div>
      </div>

    </div>
  </div>

</div>


<!-- new itin form -->
<div class="custom-modal" *ngIf="showItineraryForm">
  <ww-itinerary-form (hideItineraryForm)="hideItineraryForm($event)"></ww-itinerary-form>
</div>

<!-- show users to add as friend -->
<div class="custom-modal" *ngIf="showUsers" (click)="cancelShowUsers()"></div>
<div class="users-search" *ngIf="showUsers">

  <input type="text" placeholder="Search for people..." #text (keyup)="filterSearch(text.value)">

  <div *ngFor="let user of filteredResult" class="search-result-card">
    <img src="{{ user.display_picture }}" alt="" class="user-profile-thumbnail">
    <div class="user-details">
      <h4 class="user-username">{{ user.username }}</h4>
      <h5 class="user-search-description">{{ user.description }}</h5>
    </div>

    <div class="follow-button">
      <div *ngIf="user.following_status === 'following'">
        <div class="following-response">
          <h5 class="already-following">Following</h5>
          <h5 class="unfollow" (click)="unfollow(user)">Stop following</h5>
        </div>
      </div>
      <div *ngIf="user.following_status === 'requestedFollowing'">
        <div class="following-response">
          <h5 class="requested-following">Requested</h5>
          <h5 class="unfollow" (click)="unfollow(user)">Cancel request</h5>
        </div>
      </div>
      <div *ngIf="user.following_status === ''">
        <button type="button" class="follow-button" (click)="follow(user)"><h5>Follow</h5></button>
      </div>
    </div>
  </div>
</div>
