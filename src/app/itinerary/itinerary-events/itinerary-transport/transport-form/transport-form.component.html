<form [formGroup]="addTransportForm" (ngSubmit)="onSubmitNewTransports()">

  <div class="form-card">

    <div class="form-header">
      <h3>New transport arrangement</h3>
      <a (click)="cancelForm()">x</a>
    </div>

    <div class="textless-header"></div>

    <div class="form-housing">

      <div class="progress-tracker-section">
        <ul class="progress-tracker" [class.flight-search-active]="transportOption === 'flight'" [class.choose-airport-option]="airportsToChoose">
          <li class="progress-title" (click)="backToSelectTransport()" [class.progress-done]="transportOption !== ''">SELECT TRANSPORT MODE</li><li class="progress-title" *ngIf="transportOption === 'flight'" (click)="backToFlightSearch()" [class.progress-done]="populateFlightDetails">SEARCH FLIGHT</li><li class="progress-title" *ngIf="airportsToChoose" (click)="backToSelectAirport()" [class.progress-done]="airportsChoosen">SELECT AIRPORT</li><li class="progress-title">CONFIRM {{ transportOption | uppercase }} DETAILS</li>
        </ul>
      </div>

      <div class="transport-mode" *ngIf="transportOption === ''">
        <label>SELECT YOUR MODE OF TRANSPORT</label>
        <div *ngFor="let transport of transportType" class="transport-mode-options">
          <label (click)="onSelectTransportType(transport.name)">
            <input type="radio" formControlName="transport_type" [value]="transport.name">
            <i class="fa fa-{{ transport.icon }} fa-3x" aria-hidden="true"></i>
            {{ transport.name }}
          </label>
        </div>
      </div>

      <div *ngIf="transportOption === 'flight'">
        <form [formGroup]="searchFlightForm" class="flight-search" *ngIf="!populateFlightDetails">
          <h4 class="transport-type-header">SEARCH FOR YOUR FLIGHT</h4>

          <div class="form-section-details">
            <div class="search-airline-code">
              <label>AIRLINE CODE</label>
              <input type="text" id="search-airline-code" formControlName="searchAirlineCode" maxlength="2" autofocus>
            </div>

            <div class="search-flight-number">
              <label>FLIGHT NUMBER</label>
              <input type="number" id="search-flight-number" formControlName="searchFlightNumber" min="1" max="9999" required>
            </div>

            <div class="flight-example">
              <h6>EXAMPLE</h6>

              <div>
                <label>AIRLINE CODE</label>
                <h4 class="example-airline-code">SQ</h4>
              </div>

              <div>
                <label>FLIGHT NUMBER</label>
                <h4 class="example-flight-number">123</h4>
              </div>
            </div>

            <div class="search-dep-date">
              <label>DATE OF DEPARTURE</label>
              <select class="select-date" name="searchDepDate" formControlName="searchDepDate">
                <option *ngFor="let itinDate of itinDateRange; let i = index" [value]="itinDate">
                  <div *ngIf="itinDate !== 'any day'">
                    <h5>Day {{ i + 1 }}, {{ itinDate | date: "dd MMM yyyy (EEEE)"}}</h5>
                  </div>
                </option>
              </select>
            </div>
          </div>

          <div class="action-response">
            <button type="submit" (click)="searchFlightSubmit()" class="action-response-primary" [disabled]="!searchFlightForm.valid"><h4>SEARCH FLIGHT</h4></button>
          </div>

        </form>

        <div *ngIf="stopOver" class="stop-over">
          <h5 class="form-section-header">Your selected flight travels from and to multiple airports. Please select your departure and arrival airports.</h5>

          <h5 class="stop-over-airport">DEPARTURE AIRPORT</h5>
          <div class="select-airport" *ngFor="let airport of depAirports">
            <input name="depAirport" type="radio" (click)="selectDepAirport(airport?.airportCode)">
            <label for="depAirport">{{ airport?.city }} ({{ airport?.airportName }})</label>
          </div>

          <h5 class="stop-over-airport">ARRIVAL AIRPORT</h5>
          <div class="select-airport" *ngFor="let airport of arrAirports">
            <input name="arrAirport" type="radio" (click)="selectArrAirport(airport?.airportCode)">
            <label for="arrAirport">{{ airport?.city }} ({{ airport?.airportName }})</label>
          </div>

          <div class="action-response">
            <h4 class="action-response-primary" (click)="getFlightDetails()">GET FLIGHT DETAILS</h4>
          </div>
        </div>

        <div *ngIf="!stopOver">
          <div *ngIf="populateFlightDetails">
            <h4 class="transport-type-header"><i class="fa fa-plane fa-lg" aria-hidden="true"></i> CONFIRM FLIGHT DETAILS</h4>

            <h5 class="form-section-header">DEPARTURE DETAILS</h5>
            <div class="form-section-details">
              <label>FLIGHT NUMBER</label>
              <input type="text" class="reference-number" formControlName="reference_number" value="{{ flightSearchDetail?.carrierCode }}{{ flightSearchDetail?.reference_number }}">

              <label>DEPART FROM (CITY) <span class="required"> - required</span></label>
              <input type="text" formControlName="dep_city" value="{{ flightSearchDetail?.dep_city }}">

              <label>DEPARTURE AIRPORT</label>
              <input type="text" formControlName="dep_station" value="{{ flightSearchDetail?.dep_station }}">

              <label>TERMINAL</label>
              <input type="text" class="transport-terminal" formControlName="dep_terminal" value="{{ flightSearchDetail?.dep_terminal }}">

              <label>DEPARTURE DATE</label>
              <select class="select-date" name="dep_date" formControlName="dep_date" [value]="flightSearchDetail?.dep_date">
                <option *ngFor="let itinDate of itinDateRange; let i = index" [value]="itinDate">
                  <div *ngIf="itinDate !== 'any day'">
                    <h5>Day {{ i + 1 }}, {{ itinDate | date: "dd MMM yyyy (EEEE)"}}</h5>
                  </div>
                </option>
              </select>

              <label>DEPARTURE TIME</label>
              <input type="time" formControlName="dep_time" value="{{ flightSearchDetail?.dep_time }}">
            </div><!-- end of departure-details -->


            <h5 class="form-section-header">ARRIVAL DETAILS</h5>
            <div class="form-section-details">
              <label>GOING TO (CITY) <span class="required"> - required</span></label>
              <input type="text" formControlName="arr_city" value="{{ flightSearchDetail?.arr_city }}">

              <label>ARRIVAL AIRPORT</label>
              <input type="text" formControlName="arr_station" value="{{ flightSearchDetail?.arr_station }}">

              <label>TERMINAL</label>
              <input type="text" class="transport-terminal" formControlName="arr_terminal">

              <label>ARRIVAL DATE</label>
              <select class="select-date" name="arr_date" formControlName="arr_date" [value]="flightSearchDetail?.arr_date">
                <option *ngFor="let itinDate of itinDateRange; let i = index" [value]="itinDate">
                  <div *ngIf="itinDate !== 'any day'">
                    <h5>Day {{ i + 1 }}, {{ itinDate | date: "dd MMM yyyy (EEEE)"}}</h5>
                  </div>
                </option>
              </select>

              <label>ARRIVAL TIME</label>
              <input type="time" formControlName="arr_time" value="{{ flightSearchDetail?.arr_time }}">
            </div><!-- end of arrival-details -->


            <h5 class="form-section-header">NOTE</h5>
            <div class="form-section-details">
              <textarea name="name" rows="3" formControlName="note"></textarea>
            </div>

            <div class="action-response">
              <h4 class="action-response-secondary" (click)="cancelForm()">CANCEL</h4>
              <button type="submit" class="action-response-primary" [disabled]="!addTransportForm.valid"><h4><i class="fa fa-floppy-o" aria-hidden="true"></i> SAVE</h4></button>
            </div>
          </div>
        </div>

      </div><!-- end of flight -->


      <div *ngIf="transportOption !== ''">

        <div [ngSwitch]="transportOption" class="transport-type-header">
          <h4 *ngSwitchCase="'train'"><i class="fa fa-train fa-lg" aria-hidden="true"></i> CONFIRM TRAIN DETAILS</h4>
          <h4 *ngSwitchCase="'bus'"><i class="fa fa-bus fa-lg" aria-hidden="true"></i> CONFIRM BUS DETAILS</h4>
          <h4 *ngSwitchCase="'cruise'"><i class="fa fa-ship fa-lg" aria-hidden="true"></i> CONFIRM CRUISE DETAILS</h4>
          <h4 *ngSwitchCase="'vehicle rental'"><i class="fa fa-car fa-lg" aria-hidden="true"></i> CONFIRM VEHICLE RENTAL DETAILS</h4>
          <h4 *ngSwitchCase="'others'"><i class="fa fa-rocket fa-lg" aria-hidden="true"></i> CONFIRM OTHER TRANSPORT TYPE DETAILS</h4>
        </div>

        <div *ngIf="transportOption !== 'flight'">
          <!-- exclude flight, left train, bus, cruise, rental & others -->
          <h5 class="form-section-header">DEPARTURE DETAILS</h5>
          <div class="form-section-details">
            <div *ngIf="transportOption === 'bus'">
              <label>BUS NUMBER</label>
              <input type="text" class="reference-number" formControlName="reference_number">
            </div>

            <label>DEPART FROM (CITY) <span class="required"> - required</span></label>
            <input type="text" formControlName="dep_city">

            <!-- departure details for all other transport type except vehicle rental-->
            <div *ngIf="transportOption !== 'vehicle rental'">
              <label>DEPARTURE STATION / TERMINAL</label>
              <input type="text" formControlName="dep_station">

              <label>DEPARTURE DATE <span class="required"> - required</span></label>
              <select class="select-date" name="dep_date" formControlName="dep_date">
                <option *ngFor="let itinDate of itinDateRange; let i = index" [value]="itinDate">
                  <div *ngIf="itinDate !== 'any day'">
                    <h5>Day {{ i + 1 }}, {{ itinDate | date: "dd MMM yyyy (EEEE)"}}</h5>
                  </div>
                </option>
              </select>

              <label>DEPARTURE TIME</label>
              <input type="time" formControlName="dep_time">
            </div>

            <div *ngIf="transportOption === 'vehicle rental'">
              <label>PICK UP DATE <span class="required"> - required</span></label>
              <select class="select-date" name="dep_date" formControlName="dep_date">
                <option *ngFor="let itinDate of itinDateRange; let i = index" [value]="itinDate">
                  <div *ngIf="itinDate !== 'any day'">
                    <h5>Day {{ i + 1 }}, {{ itinDate | date: "dd MMM yyyy (EEEE)"}}</h5>
                  </div>
                </option>
              </select>

              <label>PICK UP TIME</label>
              <input type="time" formControlName="dep_time">
            </div>
          </div><!-- end of departure details -->

          <h5 class="form-section-header">ARRIVAL DETAILS</h5>
          <div class="form-section-details">
            <label>GOING TO (CITY) <span class="required"> - required</span></label>
            <input type="text" formControlName="arr_city">

            <!-- arrival details for all transport type except vehicle rental-->
            <div *ngIf="transportOption !== 'vehicle rental'">
              <label>ARRIVAL STATION / TERMINAL</label>
              <input type="text" formControlName="arr_station">

              <label>ARRIVAL DATE</label>
              <select class="select-date" name="arr_date" formControlName="arr_date">
                <option *ngFor="let itinDate of itinDateRange; let i = index" [value]="itinDate">
                  <div *ngIf="itinDate !== 'any day'">
                    <h5>Day {{ i + 1 }}, {{ itinDate | date: "dd MMM yyyy (EEEE)"}}</h5>
                  </div>
                </option>
              </select>

              <label>ARRIVAL TIME</label>
              <input type="time" formControlName="arr_time">
            </div>

            <div *ngIf="transportOption === 'vehicle rental'">
              <label>RETURN DATE</label>
              <select class="select-date" name="arr_date" formControlName="arr_date">
                <option *ngFor="let itinDate of itinDateRange; let i = index" [value]="itinDate">
                  <div *ngIf="itinDate !== 'any day'">
                    <h5>Day {{ i + 1 }}, {{ itinDate | date: "dd MMM yyyy (EEEE)"}}</h5>
                  </div>
                </option>
              </select>

              <label>RETURN TIME</label>
              <input type="time" formControlName="arr_time">
            </div>

          </div><!-- end of arrival details -->

          <!-- template for vehicle rental -->
          <div *ngIf="transportOption === 'vehicle rental'">
            <h5 class="form-section-header">RENTAL COMPANY DETAILS</h5>
            <div class="form-section-details">
              <label>RENTAL COMPANY</label>
              <input type="text" formControlName="transport_company">

              <label>CONTACT NUMBER</label>
              <input type="text" class="contact-number-input" formControlName="contact_number">
            </div>
          </div>

          <h5 class="form-section-header">NOTE</h5>
          <div class="form-section-details">
            <textarea name="name" rows="3" formControlName="note"></textarea>
          </div>

          <div class="action-response">
            <h4 class="action-response-secondary" (click)="cancelForm()">CANCEL</h4>
            <button type="submit" class="action-response-primary" [disabled]="!addTransportForm.valid"><h4><i class="fa fa-floppy-o" aria-hidden="true"></i> SAVE</h4></button>
          </div>
        </div><!-- end of details for transport exclude flight -->

      </div>
    </div>

  </div><!-- end of formCard -->

</form>
